<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>dc3db6bf0b204785bd9791473eeeee8e</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="homework-2-trees-and-calibration" class="cell markdown"
id="PmmINRw92NZ7">
<h2>Homework 2: Trees and Calibration</h2>
<h3 id="instructions">Instructions:</h3>
<p>Please upload the .ipynb, .pdf to Github prior to the deadline.
Please include your UNI as well.</p>
<p>Make sure to use the dataset that we provide in
CourseWorks/Classroom.</p>
<p>There are a lot of applied questions based on the code results.
Please make sure to answer them all. These are primarily to test your
understanding of the results your code generate (similar to any Data
Science/ML case study interviews).</p>
</section>
<div class="cell markdown" id="Paj_32xL2fBV">
<h2 id="name-apurva-patel">Name: Apurva Patel</h2>
<h2 id="uni-amp2365">UNI: amp2365</h2>
</div>
<section id="the-dataset" class="cell markdown" id="8F3SYLuF2zk6">
<h2>The Dataset</h2>
<h3 id="description">Description</h3>
<p>The Diabetes Dataset comprises medical data from 768 female patients
of Pima Indian heritage, including 8 health-related features and a
binary target indicating the presence or absence of diabetes.</p>
</section>
<div class="cell code" data-execution_count="9" id="K4qKRFeR4x9t">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="10" id="DezWRKS3DkBY">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline, Pipeline, FeatureUnion</span></code></pre></div>
</div>
<section id="question-1-decision-trees" class="cell markdown"
id="9gNer0Ey5ERR">
<h2>Question 1: Decision Trees</h2>
</section>
<div class="cell markdown" id="spGKpLA65Isu">
<p><strong>1.1: Load the provided dataset</strong></p>
</div>
<div class="cell code" data-execution_count="11" id="TIIIKt3wTB4H">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># url = &#39;https://raw.githubusercontent.com/Apurva3509/Applied-Machine-Learning/main/2/diabetes.csv?token=GHSAT0AAAAAACNAARHPWYJBTLOL4RDUZJJYZO2KQMQ&#39;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 = pd.read_csv(url)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12" id="B-cYCnq_j84Q">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/diabetes.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
id="QFG6s448TZbK" data-outputId="24a589c5-ab4f-4590-9947-4ec114369b3e">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df1</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-3797892f-0910-4c51-95cb-83adf2f92cd1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>10</td>
      <td>101</td>
      <td>76</td>
      <td>48</td>
      <td>180</td>
      <td>32.9</td>
      <td>0.171</td>
      <td>63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>764</th>
      <td>2</td>
      <td>122</td>
      <td>70</td>
      <td>27</td>
      <td>0</td>
      <td>36.8</td>
      <td>0.340</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>765</th>
      <td>5</td>
      <td>121</td>
      <td>72</td>
      <td>23</td>
      <td>112</td>
      <td>26.2</td>
      <td>0.245</td>
      <td>30</td>
      <td>0</td>
    </tr>
    <tr>
      <th>766</th>
      <td>1</td>
      <td>126</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>30.1</td>
      <td>0.349</td>
      <td>47</td>
      <td>1</td>
    </tr>
    <tr>
      <th>767</th>
      <td>1</td>
      <td>93</td>
      <td>70</td>
      <td>31</td>
      <td>0</td>
      <td>30.4</td>
      <td>0.315</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3797892f-0910-4c51-95cb-83adf2f92cd1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3797892f-0910-4c51-95cb-83adf2f92cd1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3797892f-0910-4c51-95cb-83adf2f92cd1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-35f3e248-2238-4679-a4e7-d62c3624e881">
  <button class="colab-df-quickchart" onclick="quickchart('df-35f3e248-2238-4679-a4e7-d62c3624e881')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-35f3e248-2238-4679-a4e7-d62c3624e881 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="fvwrl_RH5SAS">
<p><strong>1.2: How many instances are there in the dataset for each
class (diabetic and non-diabetic patients)? What does this tell you
about the balance of the dataset?</strong></p>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="3LfCuS4Dt-Yc" data-outputId="1b205934-3d94-4604-93f9-5aeea48ff8e1">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Outcome&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>0    500
1    268
Name: Outcome, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:388}"
id="M8mVUEW13LJt" data-outputId="08094814-11c3-44dc-d745-21392c094c2e">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span>df1.Outcome, data<span class="op">=</span>df1)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/829e5891d57f806a67a5740020643c632e8fa145.png" /></p>
</div>
</div>
<div class="cell markdown" id="iFH363t-uPm_">
<ul>
<li>There are total 500 occurance of Non diabetic(0) patients and 268
for Diabetic(1).</li>
<li>The data set is clearly imbalanced where the count of Non-diabetic
patients is more thant hat of diabetic patients.</li>
</ul>
</div>
<div class="cell markdown" id="Kivt__ZW5wIB">
<p><strong>1.3: Are there any missing values in the dataset? If so, how
will you handle them?</strong></p>
</div>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="D9_Wqbtw5q5d" data-outputId="c4d6342a-f26f-488c-81f0-60f2ff7f5f1b">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> df1.isnull().<span class="bu">sum</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Missing values in each column:&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_values)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Missing values in each column:
Pregnancies                 0
Glucose                     0
BloodPressure               0
SkinThickness               0
Insulin                     0
BMI                         0
DiabetesPedigreeFunction    0
Age                         0
Outcome                     0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="qgB85EYSu0AO">
<ul>
<li>No missing values</li>
</ul>
</div>
<div class="cell markdown" id="tde1cAL451-9">
<p><strong>1.4: Split the data into development and test datasets. Which
splitting methodology did you choose and why?</strong></p>
<p>**Hint: Based on the distribution of the data, try to use the best
splitting strategy.</p>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:866}"
id="Keqcgjob3oq6" data-outputId="cb18f605-35d8-42d9-9ab0-ead1ded4e576">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">vars</span> <span class="op">=</span> [<span class="st">&#39;Pregnancies&#39;</span>, <span class="st">&#39;Glucose&#39;</span>, <span class="st">&#39;BloodPressure&#39;</span>, <span class="st">&#39;SkinThickness&#39;</span>, <span class="st">&#39;Insulin&#39;</span>, <span class="st">&#39;BMI&#39;</span>, <span class="st">&#39;DiabetesPedigreeFunction&#39;</span>, <span class="st">&#39;Age&#39;</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>corr2 <span class="op">=</span> df1[<span class="bu">vars</span>].corr()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr2, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;cividis&#39;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.heatmap(corr2, annot=True, cmap=&#39;RdBu&#39;)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix&#39;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/3458535b7c681333a720e788c93c63beefa99c9c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
id="PPxLFGLQzaHD" data-outputId="187d9837-35e7-4516-e011-daa2dcac9c1b">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df1</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-7afb50c6-0285-4fb7-a47e-c0cd53c7e756" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>10</td>
      <td>101</td>
      <td>76</td>
      <td>48</td>
      <td>180</td>
      <td>32.9</td>
      <td>0.171</td>
      <td>63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>764</th>
      <td>2</td>
      <td>122</td>
      <td>70</td>
      <td>27</td>
      <td>0</td>
      <td>36.8</td>
      <td>0.340</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>765</th>
      <td>5</td>
      <td>121</td>
      <td>72</td>
      <td>23</td>
      <td>112</td>
      <td>26.2</td>
      <td>0.245</td>
      <td>30</td>
      <td>0</td>
    </tr>
    <tr>
      <th>766</th>
      <td>1</td>
      <td>126</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>30.1</td>
      <td>0.349</td>
      <td>47</td>
      <td>1</td>
    </tr>
    <tr>
      <th>767</th>
      <td>1</td>
      <td>93</td>
      <td>70</td>
      <td>31</td>
      <td>0</td>
      <td>30.4</td>
      <td>0.315</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7afb50c6-0285-4fb7-a47e-c0cd53c7e756')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7afb50c6-0285-4fb7-a47e-c0cd53c7e756 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7afb50c6-0285-4fb7-a47e-c0cd53c7e756');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ffe2dbc5-6fba-445c-addc-263beecb34a4">
  <button class="colab-df-quickchart" onclick="quickchart('df-ffe2dbc5-6fba-445c-addc-263beecb34a4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ffe2dbc5-6fba-445c-addc-263beecb34a4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="19" id="bGvTsjCLzZP0">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">&#39;Pregnancies&#39;</span>, <span class="st">&#39;Glucose&#39;</span>, <span class="st">&#39;BloodPressure&#39;</span>, <span class="st">&#39;SkinThickness&#39;</span>, <span class="st">&#39;Insulin&#39;</span>, <span class="st">&#39;BMI&#39;</span>, <span class="st">&#39;DiabetesPedigreeFunction&#39;</span>, <span class="st">&#39;Age&#39;</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column_name <span class="kw">in</span> columns:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> df1[column_name].value_counts()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f&quot;Unique values and their frequencies for column &#39;{column_name}&#39;:&quot;)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(counts)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print()</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20" id="1jsR9wdG6CmC">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df1_X <span class="op">=</span> df1.drop(columns<span class="op">=</span>[<span class="st">&#39;Outcome&#39;</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df1_y <span class="op">=</span> df1[<span class="st">&#39;Outcome&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="DyVzWHlxygVw" data-outputId="b3b17a45-0cb8-451e-eb24-a310a96b4e56">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Shape of feature vectors: &#39;</span>, df1_X.shape)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Shape of target vector: &#39;</span>, df1_y.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Shape of feature vectors:  (768, 8)
Shape of target vector:  (768,)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="3UMfB48v1SoE" data-outputId="80193669-057b-4854-cb97-5b88654ff763">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df1_y_array <span class="op">=</span> df1_y.to_numpy()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df1_y <span class="op">=</span> df1_y_array.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1_y.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(768, 1)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="N3e_TywpBNee" data-outputId="463063a5-6ff8-4c01-f47a-ddec997a63d4">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(df1_X, df1_y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>df1_y)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train, X_val, y_train, y_val = train_test_split(X_dev, y_dev, test_size=0.25, random_state=42, stratify=y_dev)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Shape of X_train:&quot;</span>, X_train.shape)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Shape of y_train:&quot;</span>, y_train.shape)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(&quot;Shape of y_train:&quot;, X_val.shape)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(&quot;Shape of y_train:&quot;, y_val.shape)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Shape of X_test:&quot;</span>, X_test.shape)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Shape of y_test:&quot;</span>, y_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Shape of X_train: (614, 8)
Shape of y_train: (614, 1)
Shape of X_test: (154, 8)
Shape of y_test: (154, 1)
</code></pre>
</div>
</div>
<div class="cell markdown" id="cg5UnTg_6Bxm">
<p><strong>1.5: Build a decision tree classifier to predict the onset of
diabetes. What criterion (e.g., Gini impurity, entropy) did you choose
for splitting, and why?</strong></p>
</div>
<div class="cell markdown" id="mM58rAE-SEiV">
<ul>
<li><p>I am using gini to split because I know that gini is a measure of
absolute purity and splitting is made easy when directly compared with
absolute values.</p></li>
<li><p>Also as per their formula, entropy has a log function which can
slow the process if we dont keep a max depth for the tree.</p></li>
</ul>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="1I5w-jL7E9WI" data-outputId="fcf942df-57e8-477d-b8a4-b187888f88fb">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pipe_gini <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">10</span>, criterion<span class="op">=</span><span class="st">&#39;gini&#39;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pipe_gini.fit(X_train, y_train)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Gini to split&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy Score on Train set: &quot;</span>, pipe_gini.score(X_train, y_train))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy Score on Test set: &quot;</span>, pipe_gini.score(X_test, y_test))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Gini to split
Accuracy Score on Train set:  0.9511400651465798
Accuracy Score on Test set:  0.7272727272727273
</code></pre>
</div>
</div>
<div class="cell markdown" id="iqMP3tIT6Orb">
<p><strong>1.6: Evaluate your model using accuracy, precision, recall,
and F1-score. What do these metrics reveal about your model's
performance?</strong></p>
</div>
<div class="cell code" data-execution_count="25" id="gS6JlXv-Gbko">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="Coiirj7HYA_H" data-outputId="fbc3fc69-db8d-4680-e0cb-24667cc07124">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> pipe_gini.predict(X_test)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1 score:&quot;</span>, f1)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.7272727272727273
Precision: 0.6428571428571429
Recall: 0.5
F1 score: 0.5625000000000001
</code></pre>
</div>
</div>
<div class="cell markdown" id="67_sdh4crhEL">
<ol>
<li>Accuracy: The model has an accuracy of around 72.08%, meaning it
correctly predicts the diabetes outcome for about 72.08% of the
instances in the dataset.</li>
<li>Precision: Precision of approximately 62.8% indicates that when the
model predicts a positive outcome (diabetes), it is correct around 62.8%
of the time.</li>
<li>Recall: Recall of about 50% suggests that the model is able to
correctly identify around 50% of the actual positive cases.</li>
<li>F1 Score: The F1 score, which considers both precision and recall,
is approximately 55.6%. It provides a balance between precision and
recall, giving an overall measure of the model's performance.</li>
</ol>
<ul>
<li>These metrics reveal that while the model has decent accuracy, its
performance in terms of precision, recall, and F1 score is relatively
modest. This could be due to the imbalance in the dataset, as indicated
by the lower recall value compared to precision. Improving the model's
ability to detect true positives (diabetes cases) while minimizing false
positives and false negatives would be crucial for better performance,
especially in medical diagnosis tasks like predicting diabetes. Further
model tuning, feature engineering, or utilizing techniques to handle
imbalanced datasets could potentially enhance the model's
performance.</li>
</ul>
</div>
<div class="cell markdown" id="DxTDRJqj6gfn">
<p><strong>1.8: List the top 3 most important features for this trained
tree? How would you justify these features being the most
important?</strong></p>
</div>
<div class="cell code" data-execution_count="27" id="49fYIRYndsC9">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> <span class="op">*</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> mutual_info_classif</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="kjx-HO0ChLqf" data-outputId="119a82dc-be59-4c39-b982-291d275b819a">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">&#39;Pregnancies&#39;</span>, <span class="st">&#39;Glucose&#39;</span>, <span class="st">&#39;BloodPressure&#39;</span>, <span class="st">&#39;SkinThickness&#39;</span>, <span class="st">&#39;Insulin&#39;</span>, <span class="st">&#39;BMI&#39;</span>, <span class="st">&#39;DiabetesPedigreeFunction&#39;</span>, <span class="st">&#39;Age&#39;</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>feat_imp <span class="op">=</span> pipe_gini.feature_importances_</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total features: &quot;</span>,<span class="bu">len</span>(features))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Weights for features: &quot;</span>, <span class="bu">len</span>(feat_imp))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total features:  8
Weights for features:  8
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:639}"
id="h14ByQ0GcTVe" data-outputId="00c0db80-fcb5-4e44-c19a-b3ee508e2b77">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="bu">list</span>(features), y<span class="op">=</span><span class="bu">list</span>(feat_imp), palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Feature Importances&#39;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/e6602f3cc6a42a76d280f2fb3b79b50c5bf69ffd.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="3ZZ-JYGdp2q9" data-outputId="6b3098b4-f5fa-48ca-823c-a990540c4bc7">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>imp_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Features&#39;</span>: features, <span class="st">&#39;Weights&#39;</span>: feat_imp})</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>imp_sorted <span class="op">=</span> imp_df.sort_values(by <span class="op">=</span> [<span class="st">&#39;Weights&#39;</span>], ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>imp_sorted</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">

  <div id="df-7cb2d7e3-c790-4c32-8ca2-de79b7aefa9f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Features</th>
      <th>Weights</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Glucose</td>
      <td>0.342339</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BMI</td>
      <td>0.196474</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Age</td>
      <td>0.129601</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BloodPressure</td>
      <td>0.093884</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DiabetesPedigreeFunction</td>
      <td>0.085114</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Pregnancies</td>
      <td>0.078641</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Insulin</td>
      <td>0.050527</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SkinThickness</td>
      <td>0.023421</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7cb2d7e3-c790-4c32-8ca2-de79b7aefa9f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7cb2d7e3-c790-4c32-8ca2-de79b7aefa9f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7cb2d7e3-c790-4c32-8ca2-de79b7aefa9f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d2bcc015-8b94-4c6e-a8c9-e1d9aae2cd77">
  <button class="colab-df-quickchart" onclick="quickchart('df-d2bcc015-8b94-4c6e-a8c9-e1d9aae2cd77')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d2bcc015-8b94-4c6e-a8c9-e1d9aae2cd77 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:639}"
id="4Z4DyfoZqcmb" data-outputId="6b0f4378-57e2-4e60-d3ce-1ac1e5d566c7">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">&#39;Features&#39;</span>, y<span class="op">=</span><span class="st">&#39;Weights&#39;</span>, data<span class="op">=</span>imp_sorted, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Feature Importances&#39;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/43b6bfd1985f83e66b8888a08127405f8cf9d035.png" /></p>
</div>
</div>
<div class="cell markdown" id="8K2rZ_YWkU9-">
<p>The top 3 features are:</p>
<ol>
<li>Glucose - It is directly proportionl to the amount of sugar level in
body and has the highest weight.</li>
<li>BMI - It is also relted to diabetes and has a positive influence on
making a porediction for diabetes.</li>
<li>Age - With increase in age we observe a higher chance of having
diabetes.</li>
</ol>
</div>
<section id="question-2-random-forests" class="cell markdown"
id="lFZzklLK6oqx">
<h2>Question 2: Random Forests</h2>
</section>
<div class="cell markdown" id="lGedQ_QL6sNB">
<p><strong>2.1: Train a Random Forest model on the development dataset
using RandomForestClassifier class in sklearn. Use the default
parameters. Evaluate the performance of the model on test dataset. Does
this perform better than Decision Tree on the test dataset</strong></p>
</div>
<div class="cell code" data-execution_count="32" id="F45B572ZyNsA">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">&#39;Pregnancies&#39;</span>, <span class="st">&#39;Glucose&#39;</span>, <span class="st">&#39;BloodPressure&#39;</span>, <span class="st">&#39;SkinThickness&#39;</span>, <span class="st">&#39;Insulin&#39;</span>, <span class="st">&#39;BMI&#39;</span>, <span class="st">&#39;DiabetesPedigreeFunction&#39;</span>, <span class="st">&#39;Age&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="33" id="3hygwnn5MohI">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, RandomForestRegressor</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV, GridSearchCV</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> randint</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="Mf0Qbl1u6f5O" data-outputId="52c88f01-e55d-4edc-fb0b-fdc5055c3d3b">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Random Forest accuracy score: &quot;</span>, rf_model.score(X_test, y_test))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Random Forest accuracy score:  0.7402597402597403
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1111}"
id="h4in8xKlMkaf" data-outputId="e5d83cdf-47df-4249-bc9f-da12f75f2fdc">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying first 2 trees in the forest</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> rf_model.estimators_[i]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    dot_data <span class="op">=</span> export_graphviz(tree,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                               feature_names<span class="op">=</span>X_train.columns,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                               filled<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                               max_depth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                               impurity<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                               proportion<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> graphviz.Source(dot_data)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    display(graph)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/0d090d505c49c8c69eabb139d954d5c870e7e215.svg" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/409aa86af32a65bea3cb03073b1aced74b3a70f9.svg" /></p>
</div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="0b-qgWcxNV78" data-outputId="1635baac-f1eb-4d74-f21b-f3cde0d435c5">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>feature_imp <span class="op">=</span> pd.Series(rf_model.feature_importances_).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>feature_imp</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">
<pre><code>1    0.267179
5    0.152435
7    0.136758
6    0.123744
2    0.090866
0    0.086395
4    0.073021
3    0.069603
dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown" id="qIiSQKS87D6j">
<p><strong>2.2 Does all trees in the trained random forest model have
pure leaves? How would you verify this?</strong></p>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="TIRbd2zd6_1h" data-outputId="2b760879-573e-483f-c46f-8ab297a5a177">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE: I can check if the impurity is 0 for all decision tree and then if 0 then pure leaves</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, tree <span class="kw">in</span> <span class="bu">enumerate</span>(rf_model.estimators_):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    all_pure <span class="op">=</span> <span class="bu">all</span>(impurity <span class="op">==</span> <span class="dv">0</span> <span class="cf">for</span> impurity <span class="kw">in</span> tree.tree_.impurity)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> all_pure:</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Tree </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: All leaves are pure&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;T </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: No pure leaves&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>T 1: No pure leaves
T 2: No pure leaves
T 3: No pure leaves
T 4: No pure leaves
T 5: No pure leaves
T 6: No pure leaves
T 7: No pure leaves
T 8: No pure leaves
T 9: No pure leaves
T 10: No pure leaves
T 11: No pure leaves
T 12: No pure leaves
T 13: No pure leaves
T 14: No pure leaves
T 15: No pure leaves
T 16: No pure leaves
T 17: No pure leaves
T 18: No pure leaves
T 19: No pure leaves
T 20: No pure leaves
T 21: No pure leaves
T 22: No pure leaves
T 23: No pure leaves
T 24: No pure leaves
T 25: No pure leaves
T 26: No pure leaves
T 27: No pure leaves
T 28: No pure leaves
T 29: No pure leaves
T 30: No pure leaves
T 31: No pure leaves
T 32: No pure leaves
T 33: No pure leaves
T 34: No pure leaves
T 35: No pure leaves
T 36: No pure leaves
T 37: No pure leaves
T 38: No pure leaves
T 39: No pure leaves
T 40: No pure leaves
T 41: No pure leaves
T 42: No pure leaves
T 43: No pure leaves
T 44: No pure leaves
T 45: No pure leaves
T 46: No pure leaves
T 47: No pure leaves
T 48: No pure leaves
T 49: No pure leaves
T 50: No pure leaves
T 51: No pure leaves
T 52: No pure leaves
T 53: No pure leaves
T 54: No pure leaves
T 55: No pure leaves
T 56: No pure leaves
T 57: No pure leaves
T 58: No pure leaves
T 59: No pure leaves
T 60: No pure leaves
T 61: No pure leaves
T 62: No pure leaves
T 63: No pure leaves
T 64: No pure leaves
T 65: No pure leaves
T 66: No pure leaves
T 67: No pure leaves
T 68: No pure leaves
T 69: No pure leaves
T 70: No pure leaves
T 71: No pure leaves
T 72: No pure leaves
T 73: No pure leaves
T 74: No pure leaves
T 75: No pure leaves
T 76: No pure leaves
T 77: No pure leaves
T 78: No pure leaves
T 79: No pure leaves
T 80: No pure leaves
T 81: No pure leaves
T 82: No pure leaves
T 83: No pure leaves
T 84: No pure leaves
T 85: No pure leaves
T 86: No pure leaves
T 87: No pure leaves
T 88: No pure leaves
T 89: No pure leaves
T 90: No pure leaves
T 91: No pure leaves
T 92: No pure leaves
T 93: No pure leaves
T 94: No pure leaves
T 95: No pure leaves
T 96: No pure leaves
T 97: No pure leaves
T 98: No pure leaves
T 99: No pure leaves
T 100: No pure leaves
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="kaKm3PSlfyTA" data-outputId="7c880790-daab-413f-bdbd-4105307a8a07">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, tree <span class="kw">in</span> <span class="bu">enumerate</span>(rf_model.estimators_):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    leaf_indices <span class="op">=</span> tree.<span class="bu">apply</span>(X_train)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    leaf_indices <span class="op">=</span> np.unique(leaf_indices)  <span class="co"># Ensure unique leaf indices</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    all_pure <span class="op">=</span> <span class="bu">all</span>(tree.tree_.impurity[node] <span class="op">==</span> <span class="dv">0</span> <span class="cf">for</span> node <span class="kw">in</span> leaf_indices)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> all_pure:</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Tree </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: Last leaves pure&quot;</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Tree </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: last leaves impure&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tree 1: Last leaves pure
Tree 2: Last leaves pure
Tree 3: Last leaves pure
Tree 4: Last leaves pure
Tree 5: Last leaves pure
Tree 6: Last leaves pure
Tree 7: Last leaves pure
Tree 8: Last leaves pure
Tree 9: Last leaves pure
Tree 10: Last leaves pure
Tree 11: Last leaves pure
Tree 12: Last leaves pure
Tree 13: Last leaves pure
Tree 14: Last leaves pure
Tree 15: Last leaves pure
Tree 16: Last leaves pure
Tree 17: Last leaves pure
Tree 18: Last leaves pure
Tree 19: Last leaves pure
Tree 20: Last leaves pure
Tree 21: Last leaves pure
Tree 22: Last leaves pure
Tree 23: Last leaves pure
Tree 24: Last leaves pure
Tree 25: Last leaves pure
Tree 26: Last leaves pure
Tree 27: Last leaves pure
Tree 28: Last leaves pure
Tree 29: Last leaves pure
Tree 30: Last leaves pure
Tree 31: Last leaves pure
Tree 32: Last leaves pure
Tree 33: Last leaves pure
Tree 34: Last leaves pure
Tree 35: Last leaves pure
Tree 36: Last leaves pure
Tree 37: Last leaves pure
Tree 38: Last leaves pure
Tree 39: Last leaves pure
Tree 40: Last leaves pure
Tree 41: Last leaves pure
Tree 42: Last leaves pure
Tree 43: Last leaves pure
Tree 44: Last leaves pure
Tree 45: Last leaves pure
Tree 46: Last leaves pure
Tree 47: Last leaves pure
Tree 48: Last leaves pure
Tree 49: Last leaves pure
Tree 50: Last leaves pure
Tree 51: Last leaves pure
Tree 52: Last leaves pure
Tree 53: Last leaves pure
Tree 54: Last leaves pure
Tree 55: Last leaves pure
Tree 56: Last leaves pure
Tree 57: Last leaves pure
Tree 58: Last leaves pure
Tree 59: Last leaves pure
Tree 60: Last leaves pure
Tree 61: Last leaves pure
Tree 62: Last leaves pure
Tree 63: Last leaves pure
Tree 64: Last leaves pure
Tree 65: Last leaves pure
Tree 66: Last leaves pure
Tree 67: Last leaves pure
Tree 68: Last leaves pure
Tree 69: Last leaves pure
Tree 70: Last leaves pure
Tree 71: Last leaves pure
Tree 72: Last leaves pure
Tree 73: Last leaves pure
Tree 74: Last leaves pure
Tree 75: Last leaves pure
Tree 76: Last leaves pure
Tree 77: Last leaves pure
Tree 78: Last leaves pure
Tree 79: Last leaves pure
Tree 80: Last leaves pure
Tree 81: Last leaves pure
Tree 82: Last leaves pure
Tree 83: Last leaves pure
Tree 84: Last leaves pure
Tree 85: Last leaves pure
Tree 86: Last leaves pure
Tree 87: Last leaves pure
Tree 88: Last leaves pure
Tree 89: Last leaves pure
Tree 90: Last leaves pure
Tree 91: Last leaves pure
Tree 92: Last leaves pure
Tree 93: Last leaves pure
Tree 94: Last leaves pure
Tree 95: Last leaves pure
Tree 96: Last leaves pure
Tree 97: Last leaves pure
Tree 98: Last leaves pure
Tree 99: Last leaves pure
Tree 100: Last leaves pure
</code></pre>
</div>
</div>
<div class="cell markdown" id="CWK0CAqE7SQh">
<p><strong>2.3: Assume you want to improve the performance of this
model. Also, assume that you had to pick two hyperparameters that you
could tune to improve its performance. Which hyperparameters would you
choose and why?</strong></p>
</div>
<section id="i-will-choose-these-as-my-hyperparameters"
class="cell markdown" id="pQ9I8Drdoa3u">
<h1>I will choose these as my hyperparameters:</h1>
<ol>
<li><strong>Number of Trees (n_estimators):</strong> This hyperparameter
determines the number of decision trees in the random forest. Increasing
the number of trees can lead to a more robust and stable model, as it
reduces overfitting by averaging predictions across multiple trees.</li>
</ol>
<ul>
<li>However, adding too many trees may increase computational cost and
training time.</li>
</ul>
<ol>
<li><strong>Maximum Depth of Trees (max_depth):</strong> This controls
the maximum depth of each decision tree in the random forest. Increasing
the maximum depth allows the trees to capture more complex relationships
in the data, potentially leading to better performance on the training
set.</li>
</ol>
<ul>
<li>However, deeper trees are more likely to overfit the training data
and may not generalize well to unseen data.</li>
</ul>
</section>
<div class="cell markdown" id="dfYVZUCw7hS7">
<p><strong>2.4: Now, assume you had to choose up to 5 different values
(each) for these two hyperparameters. How would you choose these values
that could potentially give you a performance lift?</strong></p>
</div>
<div class="cell markdown" id="n8lUs82n_Nha">
<p><strong>While selecting values for hyperparameters (n_estimators,
max_depth) for a RF model, it's essential to consider a range of values
that span different levels of model complexity and then we can do a
RandomizedSearch or GridSearchCV.</strong></p>
<p><strong>1. n_estimators:</strong></p>
<ul>
<li>Start with a relatively small number of trees to keep the model
simple and prevent overfitting. Values such as 50 or 100 can be good
starting points. Increase the number of trees gradually to capture more
complex patterns in the data. Values such as 200, 300, and 400 can be
considered to assess the model's scalability.</li>
</ul>
<p><strong>2. max_features:</strong></p>
<ul>
<li>This determines the maximum number of features considered for
splitting a node. It controls the randomness of each tree in the forest.
Setting max_features to a lower value can introduce more randomness and
diversity among the trees, which can help prevent overfitting and
improve generalization performance. On the other hand, setting it to a
higher value may lead to more correlated trees and potentially
overfitting.</li>
</ul>
<p>- Here's a selection of 5 values for each hyperparameter that I
chose:</p>
<pre><code>n_estimators: [50, 100, 200, 300, 1000]
max_depth: [None, 10, 20, 30, 50]</code></pre>
</div>
<div class="cell code" data-execution_count="39" id="5RvUNeRW7l-W">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR SOLUTION HERE: given in markdown above</span></span></code></pre></div>
</div>
<div class="cell markdown" id="hQa_8Uef7oXA">
<p><strong>2.5: Perform model selection using the chosen values for the
hyperparameters. Use cross-validation for finding the optimal
hyperparameters. Report on the optimal hyperparameters. Estimate the
performance of the optimal model (model trained with optimal
hyperparameters) on test dataset? Has the performance improved over your
plain-vanilla random forest model trained in Q2.1?</strong></p>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="g-yxqQKjnoHf" data-outputId="78fd1d98-efb9-44a9-a4da-eb5e25426a54">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>],  <span class="co"># trees in the forest</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_features&#39;</span>: [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>rf_model2 <span class="op">=</span> RandomForestClassifier(oob_score<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>, warm_start<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>rf_model2, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">5</span>, return_train_score<span class="op">=</span><span class="va">True</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Hyperparameters:&quot;</span>, grid_search.best_params_)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>best_rf_model <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> best_rf_model.score(X_test, y_test)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy on Test Set:&quot;</span>, accuracy)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Hyperparameters: {&#39;max_features&#39;: 3, &#39;n_estimators&#39;: 100}
Accuracy on Test Set: 0.7597402597402597
</code></pre>
</div>
</div>
<div class="cell markdown" id="sKQssHg8sCb0">
<blockquote>
<p><strong>For me the model performance did improve a bit. Looks like
the default parameters are the close to the best
hyperparamters</strong></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="dXDLXocWuR1l" data-outputId="9b6692c2-aba9-40c9-c952-3b9b8cf6951a">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>cv_scores <span class="op">=</span> cross_val_score(best_rf_model, X_train, y_train, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Cross-validation scores:&quot;</span>, cv_scores)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>mean_cv_score <span class="op">=</span> np.mean(cv_scores)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Mean Cross-validation score:&quot;</span>, mean_cv_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cross-validation scores: [0.76422764 0.81300813 0.72357724 0.7804878  0.80327869]
Mean Cross-validation score: 0.776915900306544
</code></pre>
</div>
</div>
<div class="cell markdown" id="7b-pPjmd8AOa">
<p><strong>2.6: Can you find the top 3 most important features from the
model trained in Q2.5? How do these features compare to the important
features that you found from Q1.8? If they differ, which feature set
makes more sense?</strong></p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="0hwlPB7Kuu3S" data-outputId="8da84c28-b9f9-49f5-bbea-e62d8cb25f2c">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>feat_imp <span class="op">=</span> best_rf_model.feature_importances_</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total features: &quot;</span>,<span class="bu">len</span>(features))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Weights for features: &quot;</span>, <span class="bu">len</span>(feat_imp))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total features:  8
Weights for features:  8
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:639}"
id="7w8l_nfxvGg_" data-outputId="e3a69485-0a3c-4738-f108-45e1a0febcd2">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="bu">list</span>(features), y<span class="op">=</span><span class="bu">list</span>(feat_imp), palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Feature Importances&#39;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/fbd72f83de425e561795ffaa2d932424e2b4aae0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="tmmk3WWV744q" data-outputId="db8e3a11-7447-49b5-8171-941b0f7885cf">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>imp_df2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Features&#39;</span>: features, <span class="st">&#39;Weights&#39;</span>: feat_imp})</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>imp_sorted2 <span class="op">=</span> imp_df2.sort_values(by <span class="op">=</span> [<span class="st">&#39;Weights&#39;</span>], ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>imp_sorted2</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">

  <div id="df-59d4564d-8ba5-41b4-b138-1b2e35fff648" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Features</th>
      <th>Weights</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Glucose</td>
      <td>0.292768</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BMI</td>
      <td>0.168607</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DiabetesPedigreeFunction</td>
      <td>0.124303</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Age</td>
      <td>0.123728</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BloodPressure</td>
      <td>0.088036</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Pregnancies</td>
      <td>0.078773</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Insulin</td>
      <td>0.062336</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SkinThickness</td>
      <td>0.061447</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-59d4564d-8ba5-41b4-b138-1b2e35fff648')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-59d4564d-8ba5-41b4-b138-1b2e35fff648 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-59d4564d-8ba5-41b4-b138-1b2e35fff648');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8ec7d572-7869-4bda-afb9-a3e8d802531d">
  <button class="colab-df-quickchart" onclick="quickchart('df-8ec7d572-7869-4bda-afb9-a3e8d802531d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8ec7d572-7869-4bda-afb9-a3e8d802531d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:639}"
id="LM6cHGRZvdXr" data-outputId="33deb352-303e-44f7-e84c-54d4e8b0d284">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">&#39;Features&#39;</span>, y<span class="op">=</span><span class="st">&#39;Weights&#39;</span>, data<span class="op">=</span>imp_sorted2, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Feature Importances&#39;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/7c3b88195b9027e346fb94e34bb08f585d475ecf.png" /></p>
</div>
</div>
<div class="cell markdown" id="U7sd5k_8vl47">
<ul>
<li>Here the top 2 features remain the same whereas the 3rd important
feature is changed. This is can be justified that
DiabetesPeigreeFinction is directly correlated to the diabetes
outcome.</li>
<li>If we talk about the feature set which makes more sense, the one
obtained in randomforest makes mre sense as it is a more generalized
model than a single decidsion tree.</li>
</ul>
</div>
<section id="question-3-gradient-boosted-trees" class="cell markdown"
id="HehLS7lW8Q-B">
<h2>Question 3: Gradient Boosted Trees</h2>
</section>
<div class="cell markdown" id="FNxL7Gq28XGN">
<p><strong>3.1: Choose three hyperparameters to tune
HistGradientBoostingClassifier on the development dataset using 5-fold
cross validation. For each hyperparmeter, give it 3 potential values.
Report on the time taken to do model selection for the model. Also,
report the performance of the test dataset from the optimal
models.</strong></p>
</div>
<div class="cell code" data-execution_count="47" id="O4LjNZ7KthW0">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="RlP0Y4ke8fDL" data-outputId="580462fa-014d-445f-d030-9ed76dd466b2">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> HistGradientBoostingClassifier</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>max_iter <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>]</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>max_depth <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>hgb <span class="op">=</span> HistGradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>pipe <span class="op">=</span> make_pipeline(GridSearchCV( hgb, param_grid<span class="op">=</span>{ <span class="st">&#39;learning_rate&#39;</span>: learning_rate,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&#39;max_iter&#39;</span>: max_iter, <span class="st">&#39;max_depth&#39;</span>: max_depth}, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span> ))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>pipe.fit(X_train, y_train)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> time.time()</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Time taken for model selection: </span><span class="sc">{:.2f}</span><span class="st"> seconds&quot;</span>.<span class="bu">format</span>(end_time <span class="op">-</span> start_time))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>grid_search_results <span class="op">=</span> pipe.named_steps[<span class="st">&#39;gridsearchcv&#39;</span>]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> grid_search_results.best_params_</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> grid_search_results.best_score_</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> pipe.score(X_test, y_test)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best train score:&quot;</span>, best_score)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters:&quot;</span>, best_params)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test score:&quot;</span>, test_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Time taken for model selection: 25.29 seconds
Best train score: 0.7671731307477009
Best parameters: {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 2, &#39;max_iter&#39;: 200}
Test score: 0.7207792207792207
</code></pre>
</div>
</div>
<div class="cell markdown" id="tFs84nru8ius">
<p><strong>3.2: Train an XGBoost model by tuning 3 hyperparameters using
10 fold cross-validation. Compare the performance of the trained XGBoost
model on the test dataset against the performances obtained from
3.1</strong></p>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="ktepV1Bt8KFi" data-outputId="8ae81fa8-f2df-4075-9bc1-d60040a57bf2">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>],</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>],</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="op">=</span> xgb.XGBClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>pipe_xgb <span class="op">=</span> make_pipeline(GridSearchCV(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    xgb_model,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>params,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>pipe_xgb.fit(X_train, y_train)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> time.time()</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Time taken for model selection: </span><span class="sc">{:.2f}</span><span class="st"> seconds&quot;</span>.<span class="bu">format</span>(end_time <span class="op">-</span> start_time))</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>grid_search_results_xgb <span class="op">=</span> pipe_xgb.named_steps[<span class="st">&#39;gridsearchcv&#39;</span>]</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>best_params_xgb <span class="op">=</span> grid_search_results_xgb.best_params_</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>best_score_xgb <span class="op">=</span> grid_search_results_xgb.best_score_</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>y_pred_xgb <span class="op">=</span> pipe_xgb.predict(X_test)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>test_score_xgb <span class="op">=</span> accuracy_score(y_test, y_pred_xgb)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best train score:&quot;</span>, best_score_xgb)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters:&quot;</span>, best_params_xgb)</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test score:&quot;</span>, test_score_xgb)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Time taken for model selection: 23.64 seconds
Best train score: 0.7669751454257007
Best parameters: {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 200}
Test score: 0.7467532467532467
</code></pre>
</div>
</div>
<div class="cell markdown" id="ZBzc4Mcx9IBT">
<p><strong>3.3: Can you list the top 3 features from the trained XGBoost
model? How do they differ from the features found from Random Forest and
Decision Tree? Which one would you trust the most?</strong></p>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:749}"
id="ldz7MYy5w43H" data-outputId="19c5bae4-e29a-4481-d1e0-35994de17526">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="op">=</span> pipe_xgb.named_steps[<span class="st">&#39;gridsearchcv&#39;</span>].best_estimator_</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>feat_imp <span class="op">=</span> xgb_model.feature_importances_</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to store feature names and their importances</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>imp_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Features&#39;</span>: features, <span class="st">&#39;Weights&#39;</span>: feat_imp})</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame based on feature importances</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>imp_sorted <span class="op">=</span> imp_df.sort_values(by<span class="op">=</span><span class="st">&#39;Weights&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the sorted feature importances</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">&#39;Features&#39;</span>, y<span class="op">=</span><span class="st">&#39;Weights&#39;</span>, data<span class="op">=</span>imp_sorted, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Feature Importances (XGBoost)&#39;</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>top_feat_indices <span class="op">=</span> feat_imp.argsort()[<span class="op">-</span><span class="dv">3</span>:][::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> [features[i] <span class="cf">for</span> i <span class="kw">in</span> top_feat_indices]</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Top 3 features from XGBoost model:&quot;</span>, top_features)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bb40cdc185e24b028f3347ac07e1a035/6f0b4be4feb6047c267145d809487386a522639e.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Top 3 features from XGBoost model: [&#39;Glucose&#39;, &#39;Age&#39;, &#39;BMI&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="DvJwLfIS8sTi">
<p><strong>3.4 Can you choose the top 7 features (as given by feature
importances from XGBoost) and repeat Q3.2? Does this model perform
better than the one trained in Q3.2? Why or why not is the performance
better?</strong></p>
</div>
<div class="cell code" data-execution_count="56"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="zium-SOj8lhS" data-outputId="0ae1c161-a06b-4766-9a92-91f6cbd1bc6e">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">## YOUR CODE HERE</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>top_feat_indices <span class="op">=</span> feat_imp.argsort()[<span class="op">-</span><span class="dv">7</span>:][::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> [features[i] <span class="cf">for</span> i <span class="kw">in</span> top_feat_indices]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>X_train_top <span class="op">=</span> X_train[top_features]</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>X_test_top <span class="op">=</span> X_test[top_features]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>xgb_model_top <span class="op">=</span> xgb.XGBClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>pipe_xgb_top <span class="op">=</span> make_pipeline(GridSearchCV(</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    xgb_model_top,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>params,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>pipe_xgb_top.fit(X_train_top, y_train)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> time.time()</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Time taken for model selection with top 7 features: </span><span class="sc">{:.2f}</span><span class="st"> seconds&quot;</span>.<span class="bu">format</span>(end_time <span class="op">-</span> start_time))</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>test_score_xgb_top <span class="op">=</span> pipe_xgb_top.score(X_test_top, y_test)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test score with top 7 features:&quot;</span>, test_score_xgb_top)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Time taken for model selection with top 7 features: 19.38 seconds
Test score with top 7 features: 0.7402597402597403
</code></pre>
</div>
</div>
<div class="cell markdown" id="-XKO8JAvx6oU">
<ul>
<li>No for me the performance isn't better than firts one because here
essentially we are dropping one feature which has +ve correlation with
the model.</li>
<li>This in return reduces the test accuracy.</li>
</ul>
</div>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="UWG103W-zLar" data-outputId="375af196-671f-4044-a23f-f8d70b39c106">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">&#39;/content/drive/MyDrive/2&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69" id="BomJJdgg0OZo">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nbconvert</span></code></pre></div>
</div>
</body>
</html>
